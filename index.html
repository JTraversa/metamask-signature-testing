<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Thu Feb 27 2020 01:18:31 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e545902eb54f77ae5e6696f" data-wf-site="5e545902eb54f77d39e6696e">
<head>
  <meta charset="utf-8">
  <title>DefiHedge</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/julios-blank-site-e50fbc.webflow.css" rel="stylesheet" type="text/css">
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
</head>
<body class="body">
  <div class="section">
    <div class="container w-container">
      <div class="bannerblock w-clearfix">
        <div class="useraddress" id="useraddress">0x-------------------------</div>
		<div class="txstatus1" id="txstatus1">Tx:</div>
		<div class="useraddresslabel">User Address:</div>
      </div>
      <div class="columns w-row">
        
        <div class="takecolumn w-col w-col-4 w-col-small-small-stack">

          <a href="#" class="authorizebutton2 w-button" type="button" id= "authorizebutton2" onclick="approveERC()">Authorize Token</a>
		  <a data-w-id="01516053-af32-daae-a25d-18c9f4294142" href="#" class="takeofferbutton w-button" id="takeofferbutton" type="button" onclick="createAndTake()">Create/Take</a></div>
      </div>
    </div>
  </div>
  <script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js"
        type="application/javascript"></script>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js" type="text/javascript" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <script src="https://unpkg.com/@metamask/legacy-web3@latest/dist/metamask.web3.min.js"></script>
  <script src="js/bignumber.min.js"></script>
  <script src="js/ethereumjs-util.js"></script>
  <script src="js/ethereumjs-abi.js"></script>
<script>
var swivelContractABI = [{"inputs":[{"internalType":"uint256","name":"i","type":"uint256"},{"internalType":"address","name":"c","type":"address"},{"internalType":"address","name":"v","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"key","type":"bytes32"}],"name":"Cancel","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"orderKey","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"agreementKey","type":"bytes32"}],"name":"Initiate","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"orderKey","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"agreementKey","type":"bytes32"}],"name":"Release","type":"event"},{"inputs":[],"name":"CTOKEN","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"DOMAIN","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"NAME","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"VERSION","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"},{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"agreements","outputs":[{"internalType":"address","name":"maker","type":"address"},{"internalType":"address","name":"taker","type":"address"},{"internalType":"address","name":"underlying","type":"address"},{"internalType":"bool","name":"floating","type":"bool"},{"internalType":"bool","name":"released","type":"bool"},{"internalType":"uint256","name":"rate","type":"uint256"},{"internalType":"uint256","name":"principal","type":"uint256"},{"internalType":"uint256","name":"interest","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"release","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"key","type":"bytes32"},{"internalType":"address","name":"maker","type":"address"},{"internalType":"address","name":"underlying","type":"address"},{"internalType":"bool","name":"floating","type":"bool"},{"internalType":"uint256","name":"principal","type":"uint256"},{"internalType":"uint256","name":"interest","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"expiry","type":"uint256"}],"internalType":"struct Hash.Order[]","name":"o","type":"tuple[]"},{"internalType":"uint256[]","name":"a","type":"uint256[]"},{"internalType":"bytes32","name":"k","type":"bytes32"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct Sig.Components[]","name":"c","type":"tuple[]"}],"name":"batchFillFixed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"key","type":"bytes32"},{"internalType":"address","name":"maker","type":"address"},{"internalType":"address","name":"underlying","type":"address"},{"internalType":"bool","name":"floating","type":"bool"},{"internalType":"uint256","name":"principal","type":"uint256"},{"internalType":"uint256","name":"interest","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"expiry","type":"uint256"}],"internalType":"struct Hash.Order[]","name":"o","type":"tuple[]"},{"internalType":"uint256[]","name":"a","type":"uint256[]"},{"internalType":"bytes32","name":"k","type":"bytes32"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct Sig.Components[]","name":"c","type":"tuple[]"}],"name":"batchFillFloating","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32[]","name":"o","type":"bytes32[]"},{"internalType":"bytes32[]","name":"a","type":"bytes32[]"}],"name":"batchRelease","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"key","type":"bytes32"},{"internalType":"address","name":"maker","type":"address"},{"internalType":"address","name":"underlying","type":"address"},{"internalType":"bool","name":"floating","type":"bool"},{"internalType":"uint256","name":"principal","type":"uint256"},{"internalType":"uint256","name":"interest","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"expiry","type":"uint256"}],"internalType":"struct Hash.Order","name":"o","type":"tuple"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct Sig.Components","name":"c","type":"tuple"}],"name":"cancel","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"cancelled","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"key","type":"bytes32"},{"internalType":"address","name":"maker","type":"address"},{"internalType":"address","name":"underlying","type":"address"},{"internalType":"bool","name":"floating","type":"bool"},{"internalType":"uint256","name":"principal","type":"uint256"},{"internalType":"uint256","name":"interest","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"expiry","type":"uint256"}],"internalType":"struct Hash.Order","name":"o","type":"tuple"},{"internalType":"uint256","name":"a","type":"uint256"},{"internalType":"bytes32","name":"k","type":"bytes32"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct Sig.Components","name":"c","type":"tuple"}],"name":"fillFixed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"key","type":"bytes32"},{"internalType":"address","name":"maker","type":"address"},{"internalType":"address","name":"underlying","type":"address"},{"internalType":"bool","name":"floating","type":"bool"},{"internalType":"uint256","name":"principal","type":"uint256"},{"internalType":"uint256","name":"interest","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"expiry","type":"uint256"}],"internalType":"struct Hash.Order","name":"o","type":"tuple"},{"internalType":"uint256","name":"a","type":"uint256"},{"internalType":"bytes32","name":"k","type":"bytes32"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct Sig.Components","name":"c","type":"tuple"}],"name":"fillFloating","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"filled","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"o","type":"bytes32"},{"internalType":"bytes32","name":"a","type":"bytes32"}],"name":"releaseFixed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"o","type":"bytes32"},{"internalType":"bytes32","name":"a","type":"bytes32"}],"name":"releaseFloating","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}]

var erc20ABI = [{"constant": false,"inputs": [{"internalType": "address","name": "","type": "address"},{"internalType": "uint256","name": "","type": "uint256"}],"name": "approve","outputs": [{"internalType": "bool","name": "","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"constant": false,"inputs": [{"internalType": "address","name": "_owner","type": "address"}],"name": "balanceOf","outputs": [{"internalType": "uint256","name": "balance","type": "uint256"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"constant": false,"inputs": [{"internalType": "address","name": "","type": "address"},{"internalType": "uint256","name": "","type": "uint256"}],"name": "transfer","outputs": [{"internalType": "bool","name": "","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"constant": false,"inputs": [{"internalType": "address","name": "sender","type": "address"},{"internalType": "address","name": "recipient","type": "address"},{"internalType": "uint256","name": "amount","type": "uint256"}],"name": "transferFrom","outputs": [{"internalType": "bool","name": "","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"}];
 
// Swivel Address
var swivelContractAddress = "0x416D738C564C2062F22Af6232406899C6bc72AAe";
var swivelContract = web3.eth.contract(swivelContractABI).at(swivelContractAddress);
// Dai Address
var tokenaddress = '0x4F96Fe3b7A6Cf9725f59d353F723c1bDb64CA6Aa';
var tokencontract = web3.eth.contract(erc20ABI).at(tokenaddress);

///connect to web3 & get default account address
function getAccounts(callback) {
    signer.getAddress().then(function(result,error) {
        if (error) {
            console.log(error);
        } else {
            callback(result);
        }
    });
}
if (window.ethereum) {
		  var web3 = new Web3(window.ethereum);
		  var provider = new ethers.providers.Web3Provider(window.ethereum);
		  var signer = provider.getSigner();
		  var ethersSwivelContract = new ethers.Contract(swivelContractAddress, swivelContractABI, signer);
		  account = getAccounts(function(result) {
		  console.log(result);
		  document.getElementById("useraddress").innerHTML = result;
});
}

async function createAndTake() { 
const currentAddress = ethereum.selectedAddress;
const makerOrderHash = web3.sha3(Math.random().toString());
const takerOrderHash = web3.sha3('testhash');
const takerVolume = web3.toWei("3");
const msgParams = {
      domain: {
        name: 'Swivel Finance',
        version: '1.0.0',
        chainId: 5,
        verifyingContract: '0x416D738C564C2062F22Af6232406899C6bc72AAe'
      },
      message: {
      key: makerOrderHash,
      maker: currentAddress,
      underlying: '0x84b5ce3eA8CDC1B19Ea1768F1C4075b6937b483b',
      floating: false,
      principal: web3.toWei('100'),
      interest: web3.toWei('5'),
      duration: '12345',
      expiry: '1615879257',
    },
      primaryType: 'Order',
      types: {
        EIP712Domain: [
          { name: 'name', type: 'string' },
          { name: 'version', type: 'string' },
          { name: 'chainId', type: 'uint256' },
          { name: 'verifyingContract', type: 'address' },
        ],
	Order: [
		{ name: 'key', type: 'bytes32' },
		{ name: 'maker', type: 'address' },
		{ name: 'underlying', type: 'address' },
		{ name: 'floating', type: 'bool' },
		{ name: 'principal', type: 'uint256' },
		{ name: 'interest', type: 'uint256' },
		{ name: 'duration', type: 'uint256' },
		{ name: 'expiry', type: 'uint256' },
	]
      },
    }
    try {
      const signature = await ethereum.request({
        method: 'eth_signTypedData_v4',
        params: [currentAddress, JSON.stringify(msgParams)],
      })
		console.log(signature);
		const split = EthJS.Util.fromRpcSig(signature);
		console.log(split);

		ethersSwivelContract.fillFixed(
		[msgParams.message.key, 
		msgParams.message.maker,
		msgParams.message.underlying,
		msgParams.message.floating,
		msgParams.message.principal,
		msgParams.message.interest,
		msgParams.message.duration,
		msgParams.message.expiry],
		takerVolume,
		takerOrderHash,
		[split.v,
		split.r,
		split.s],
		).then(function(result,error){
			if(!error)
				console.log(result);
			else
				console.error(error);
		});
    } catch (err) {
      console.error(err);
    }
}		

function approveERC (type) {
tokencontract.approve('0x416D738C564C2062F22Af6232406899C6bc72AAe', '10000000000000000000000000000000000000000000000000', function (error, result) {console.log(result)});

}



    </script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>